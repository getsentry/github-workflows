# This isn't a reusable workflow but an actual CI action for this repo itself - to test the workflows.
name: Danger Workflow Tests

on:
  pull_request:
    types: [opened, synchronize, reopened, edited, ready_for_review]

permissions:
  contents: read
  pull-requests: write
  statuses: write

jobs:
  # Test Danger action on pull requests - should analyze PR and report findings
  pr-analysis:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run danger action
        id: danger
        uses: ./danger

      - name: Validate danger outputs
        env:
          DANGER_OUTCOME: ${{ steps.danger.outputs.outcome }}
        shell: pwsh
        run: |
          Write-Host "üîç Validating Danger action outputs..."
          Write-Host "Danger Outcome: '$env:DANGER_OUTCOME'"

          # Validate that Danger ran successfully
          # T
          $env:DANGER_OUTCOME | Should -Be "success"

          Write-Host "‚úÖ Danger PR analysis completed successfully!"
          Write-Host "‚ÑπÔ∏è  Check the PR comments for any Danger findings"
